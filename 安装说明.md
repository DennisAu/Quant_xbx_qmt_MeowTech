# ∞MeowTech.实盘无限守护 - 安装说明

> **作者**:  ∞MeowTech @萌新小强 @无限进化 @萌新小王 @大蒜
> **创建时间**: 2025年06月27日 14:30  
> **版本**: 3.0  
> **适用系统**: Windows 10/11  

## 📋 系统要求

### 基础要求
- **操作系统**: Windows 10 (1903+) 或 Windows 11
- **Python版本**: Python 3.8 - 3.11 (推荐 3.9+)
- **内存**: 最低 4GB RAM (推荐 8GB+)
- **磁盘空间**: 至少 500MB 可用空间
- **网络**: 稳定的互联网连接

### 软件依赖
- **QMT客户端**: 迅投QMT量化交易客户端
- **彩虹客户端**: (可选) 彩虹客户端数据源
- **管理员权限**: 开机启动功能需要管理员权限

## 🚀 快速安装

### 方法一：使用 requirements.txt (推荐)

1. **下载程序文件**
   ```bash
   # 将 QMT_Guider.py 放置到框架目录
   # 例如：e:\select_stock_frame\program\QMT_Guider.py
   ```

2. **安装依赖库**
   ```bash
   # 在命令提示符中执行
   pip install -r requirements.txt
   ```

3. **验证安装**
   ```bash
   # 运行程序验证
   python QMT_Guider.py
   ```

### 方法二：逐个安装依赖

```bash
# 核心依赖库
pip install psutil>=5.8.0
pip install schedule>=1.1.0
pip install PySide6>=6.4.0

# 可选：如果需要更好的性能
pip install --upgrade pip
```

## 📦 依赖库详细说明

### 1. psutil (进程和系统监控)

**版本要求**: >= 5.8.0  
**功能**: 系统和进程监控  
**用途**: 
- 监控QMT和彩虹客户端进程状态
- 获取系统资源使用情况
- 进程启动、关闭和管理
- 网络连接状态监控

**安装命令**:
```bash
pip install psutil>=5.8.0
```

### 2. schedule (定时任务)

**版本要求**: >= 1.1.0  
**功能**: 定时任务调度  
**用途**: 
- QMT和彩虹客户端定时重启
- 系统定时关机
- 数据清理定时任务
- 监控任务调度

**安装命令**:
```bash
pip install schedule>=1.1.0
```

### 3. PySide6 (图形界面)

**版本要求**: >= 6.4.0  
**功能**: Qt6图形界面框架  
**用途**: 
- 主程序图形界面
- 配置页面和设置界面
- 实时状态显示
- 系统托盘功能

**安装命令**:
```bash
pip install PySide6>=6.4.0
```

## 🔧 安装验证

### 验证脚本

创建 `check_installation.py` 文件：

```python
#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
安装验证脚本
作者: ∞MeowTech
创建时间: 2025年01月27日 14:30
"""

import sys
import importlib

def check_python_version():
    """检查Python版本"""
    version = sys.version_info
    print(f"Python版本: {version.major}.{version.minor}.{version.micro}")
    
    if version.major != 3:
        print("❌ 错误: 需要Python 3.x版本")
        return False
    
    if version.minor < 8:
        print("❌ 错误: 需要Python 3.8或更高版本")
        return False
    
    print("✅ Python版本检查通过")
    return True

def check_package(package_name, min_version=None):
    """检查包是否安装"""
    try:
        module = importlib.import_module(package_name)
        if hasattr(module, '__version__'):
            version = module.__version__
            print(f"✅ {package_name}: {version}")
        else:
            print(f"✅ {package_name}: 已安装")
        return True
    except ImportError:
        print(f"❌ {package_name}: 未安装")
        return False

def main():
    """主验证函数"""
    print("=" * 50)
    print("∞MeowTech.实盘无限守护 - 安装验证")
    print("=" * 50)
    
    # 检查Python版本
    if not check_python_version():
        return False
    
    print("\n检查依赖库:")
    print("-" * 30)
    
    # 检查必需的包
    required_packages = [
        'psutil',
        'schedule', 
        'PySide6'
    ]
    
    all_installed = True
    for package in required_packages:
        if not check_package(package):
            all_installed = False
    
    print("\n" + "=" * 50)
    if all_installed:
        print("✅ 所有依赖库安装完成，可以运行程序！")
        print("\n启动命令: python QMT_Guider.py")
    else:
        print("❌ 部分依赖库未安装，请先安装缺失的库")
        print("\n安装命令: pip install psutil schedule PySide6")
    
    print("=" * 50)
    return all_installed

if __name__ == "__main__":
    main()
    input("\n按回车键退出...")
```

### 运行验证

```bash
# 运行验证脚本
python check_installation.py
```

**预期输出**:
```
==================================================
∞MeowTech.实盘无限守护 - 安装验证
==================================================
Python版本: 3.9.7
✅ Python版本检查通过

检查依赖库:
------------------------------
✅ psutil: 5.9.4
✅ schedule: 1.2.0
✅ PySide6: 6.4.2

==================================================
✅ 所有依赖库安装完成，可以运行程序！

启动命令: python Trd3_无限守护.py
==================================================
```

## 🛠️ 常见问题解决

### 1. pip 安装速度慢

**问题**: pip下载速度慢或超时

**解决方案**:
```bash
# 使用国内镜像源
pip install -i https://pypi.tuna.tsinghua.edu.cn/simple/ psutil schedule PySide6

# 或者配置永久镜像源
pip config set global.index-url https://pypi.tuna.tsinghua.edu.cn/simple/
```

**常用镜像源**:
- 清华大学: `https://pypi.tuna.tsinghua.edu.cn/simple/`
- 阿里云: `https://mirrors.aliyun.com/pypi/simple/`
- 中科大: `https://pypi.mirrors.ustc.edu.cn/simple/`

### 2. PySide6 安装失败

**问题**: PySide6安装时出现编译错误或下载失败

**解决方案**:
```bash
# 方法1: 升级pip和setuptools
pip install --upgrade pip setuptools wheel
pip install PySide6

# 方法2: 使用预编译版本
pip install --only-binary=all PySide6

# 方法3: 指定版本安装
pip install PySide6==6.4.0

# 方法4: 使用conda安装
conda install -c conda-forge pyside6
```

### 3. 权限问题

**问题**: 安装时提示权限不足

**解决方案**:
```bash
# Windows: 以管理员身份运行命令提示符
# 或者安装到用户目录
pip install --user psutil schedule PySide6
```

### 4. Python版本冲突

**问题**: 系统中有多个Python版本

**解决方案**:
```bash
# 指定Python版本安装
python3.9 -m pip install psutil schedule PySide6

# 或者使用虚拟环境
python -m venv guardian_env
guardian_env\Scripts\activate
pip install psutil schedule PySide6
```

### 5. 模块导入错误

**问题**: 运行时提示 "No module named 'xxx'"

**解决方案**:
```bash
# 检查安装位置
pip show psutil
pip show schedule
pip show PySide6

# 重新安装
pip uninstall psutil schedule PySide6
pip install psutil schedule PySide6
```

## 🔄 升级和维护

### 升级依赖库

```bash
# 升级所有依赖库到最新版本
pip install --upgrade psutil schedule PySide6

# 查看当前版本
pip list | findstr "psutil schedule PySide6"

# 查看可升级的包
pip list --outdated
```

### 清理和重装

```bash
# 完全卸载后重装
pip uninstall psutil schedule PySide6 -y
pip install psutil schedule PySide6

# 清理pip缓存
pip cache purge
```

## 📁 目录结构

安装完成后，建议的目录结构：

```
e:\select_stock_frame\program\
├── Trd3_无限守护.py          # 主程序文件
├── requirements.txt           # 依赖库列表
├── check_installation.py      # 安装验证脚本
├── logs\                     # 日志和配置目录
│   ├── guardian_config.json  # 配置文件
│   ├── guardian.log          # 运行日志
│   └── server_test.log       # 服务器测试日志
└── 无限守护说明文档\          # 文档目录
    ├── README_无限守护 功能说明.md
    ├── 安装说明.md
    ├── 配置参数说明.md
    └── ...
```

## 🚀 首次运行

### 1. 启动程序

```bash
# 在程序目录下运行
cd e:\select_stock_frame\program
python QMT_Guider.py
```

### 2. 初始配置

1. **配置QMT路径**: 在配置页面设置QMT客户端的安装路径
2. **配置时间**: 设置重启和关闭时间
3. **配置通知**: (可选) 设置飞书通知
4. **保存配置**: 点击"保存配置"按钮

### 3. 测试功能

1. **测试QMT启动**: 点击"立即重启QMT"按钮
2. **测试行情源**: 观察行情源优选结果
3. **测试定时任务**: 启用定时任务并观察状态

## 🔒 安全注意事项

### 1. 管理员权限
- 开机启动功能需要管理员权限
- 首次设置开机启动时会提示权限确认
- 建议以管理员身份运行程序

### 2. 防火墙设置
- 程序需要网络访问权限进行服务器测试
- 如果防火墙阻止，请添加程序到白名单

### 3. 杀毒软件
- 某些杀毒软件可能误报进程管理功能
- 如遇误报，请添加程序到信任列表

## 📞 技术支持

### 获取帮助
- **文档**: 查看 `无限守护说明文档` 目录下的详细文档
- **日志**: 检查 `logs` 目录下的日志文件
- **验证**: 运行 `check_installation.py` 验证安装

### 常用命令

```bash
# 查看Python版本
python --version

# 查看已安装的包
pip list

# 查看包详细信息
pip show psutil

# 测试导入
python -c "import psutil, schedule, PySide6; print('所有模块导入成功')"
```

---

**技术支持**: ∞MeowTech  
**更新日期**: 2025年01月27日  
**文档版本**: 3.0  
**适用程序版本**: 实盘无限守护 v3.0+